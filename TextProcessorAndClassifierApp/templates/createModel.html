{% extends 'base.html' %}
{% load static %}

{% block title %}Model Oluştur{% endblock %}
{% block extra_css %}
<style>
    .parameter-group {
        margin-top: 15px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center">Model Oluştur</h1>

    <form method="post" action="{% url 'choice_model_components' %}" id="modelForm">
        {% csrf_token %}

        <!-- Algoritma seçimi -->
        <div class="form-group">
            <label for="algorithm">Algoritma Seçin:</label>
            <select id="algorithm" name="algorithm" class="form-control" required>
                <option value="SVM">SVM</option>
                <option value="Random Forest">Random Forest</option>
                <option value="Logistic Regression">Logistic Regression</option>
                <option value="Naive Bayes">Naive Bayes</option>
                <option value="Decision Tree">Decision Tree</option>
                <option value="KNN">K-Nearest Neighbors</option>
                <option value="Gradient Boosting">Gradient Boosting</option>
            </select>
        </div>

        <!-- Vektörleştirici seçimi -->
        <div class="form-group mt-3">
            <label for="vectorizer">Vektörleştirici Seçin:</label>
            <select id="vectorizer" name="vectorizer" class="form-control" required>
                <option value="TF-IDF">TF-IDF</option>
                <option value="Count">Count Vectorizer</option>
                <option value="Hashing">Hashing Vectorizer</option>
            </select>
        </div>

        <!-- Test seti oranı -->
        <div class="form-group mt-3">
            <label for="test_size">Test Seti Oranı:</label>
            <input type="number" step="0.01" id="test_size" name="test_size" value="0.2" class="form-control" min="0" max="1" required>
        </div>

        <!-- Rastgele durum -->
        <div class="form-group mt-3">
            <label for="random_state">Random State:</label>
            <input type="number" id="random_state" name="random_state" value="42" class="form-control" required>
        </div>

        <!-- Algoritma özel parametreleri -->
        <div class="form-group mt-3" id="algorithm-parameters">
            <div id="SVM-parameters" class="parameter-group" style="display: none;">
                <label for="c_value">C (Regularization):</label>
                <input type="number" step="0.1" id="c_value" name="c_value" value="1.0" class="form-control">
            </div>
            <div id="Random-Forest-parameters" class="parameter-group" style="display: none;">
                <label for="max_depth">Maksimum Derinlik:</label>
                <input type="number" id="max_depth" name="max_depth" class="form-control">
                <label for="n_estimators" class="mt-3">Estimator Sayısı:</label>
                <input type="number" id="n_estimators" name="n_estimators" value="100" class="form-control">
            </div>
            <div id="Logistic-Regression-parameters" class="parameter-group" style="display: none;">
                <label for="logistic_c_value">C (Regularization):</label>
                <input type="number" step="0.1" id="logistic_c_value" name="c_value" value="1.0" class="form-control">
            </div>
            <div id="Decision-Tree-parameters" class="parameter-group" style="display: none;">
                <label for="max_depth">Maksimum Derinlik:</label>
                <input type="number" id="max_depth" name="max_depth" class="form-control">
            </div>
            <div id="KNN-parameters" class="parameter-group" style="display: none;">
                <label for="n_neighbors">Komşu Sayısı:</label>
                <input type="number" id="n_neighbors" name="n_neighbors" value="5" class="form-control">
            </div>
        </div>

        <button type="submit" class="btn btn-primary mt-4">Modeli Oluştur</button>
    </form>
</div>
{% endblock %}
{% block extra_js %}
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const algorithmSelect = document.getElementById("algorithm");
        const parameterGroups = document.querySelectorAll(".parameter-group");

        algorithmSelect.addEventListener("change", () => {
            parameterGroups.forEach(group => group.style.display = "none");
            const selectedAlgorithm = algorithmSelect.value.replace(/ /g, '-');
            const activeGroup = document.getElementById(`${selectedAlgorithm}-parameters`);
            if (activeGroup) {
                activeGroup.style.display = "block";
            }
        });

        algorithmSelect.dispatchEvent(new Event("change"));
    });
</script>
{% endblock %}
